(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();class E{static createNxNMatrix(r,o,a){const n=new Array,l=r.getImageData(0,0,o,a).data;for(let t=0;t<a;t++){n.push(new Array);for(let e=0;e<o;e++)n[t].push(new Array),n[t][e].push(l[4*(t*o+e)+0]),n[t][e].push(l[4*(t*o+e)+1]),n[t][e].push(l[4*(t*o+e)+2]),n[t][e].push(l[4*(t*o+e)+3])}return n}}class R{context;canvas;imageCopy;copy;constructor(r,o){this.context=r,this.canvas=o}fillCanvas(r){let o=this.context.createPattern(r,"no-repeat");this.canvas.width=r.width,this.canvas.height=r.height,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.fillStyle=o,this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.imageCopy=r,this.copy=E.createNxNMatrix(this.context,r.width,r.height)}resetCanvasToOriginalImage(){let r=this.context.createPattern(this.imageCopy,"no-repeat");this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.fillStyle=r,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}applyFilter(r){let o=r.apply(this.copy,this.context);this.context.putImageData(o,0,0)}}class T{constructor(){}apply(r,o){let a=r[0].length,n=r.length;const s=o.createImageData(a,n),l=s.data;for(let t=0;t<n;t++)for(let e=0;e<a;e++)l[4*(t*a+e)+0]=0,l[4*(t*a+e)+1]=0,l[4*(t*a+e)+2]=r[t][e][2],l[4*(t*a+e)+3]=r[t][e][3];return s}}class I{static fromRGBtoHSV(r){let[o,a,n]=r;o/=255,a/=255,n/=255;const s=Math.min(o,a,n),l=Math.max(o,a,n);let t=0;const e=l==0?0:1-s/l,c=l;return l==s?t=0:l==o?t=60*((a-n)/(l-s))+0:l==a?t=60*((n-o)/(l-s))+120:l==n&&(t=60*((o-a)/(l-s))+240),[t,e,c]}static desaturate(r){r[1]=r[1]*.5}static fromHSVtoRGB(r){let[o,a,n]=r;o=(o%360+360)%360;let s,l;const t=Math.floor(o/60)%6,e=o/60-t,c=n*(1-a),p=n*(1-e*a),m=n*(1-(1-e)*a);if(n==0)return[0,0,0];if(a==0){const y=Math.round(n*255);return[y,y,y]}switch(t){case 0:s=[n,m,c];break;case 1:s=[p,n,c];break;case 2:s=[c,n,m];break;case 3:s=[c,p,n];break;case 4:s=[m,c,n];break;case 5:s=[n,c,p];break}return l=[s[0]*255,s[1]*255,s[2]*255],l}}class L{constructor(){}apply(r,o){let a=r[0].length,n=r.length;const s=o.createImageData(a,n),l=s.data;for(let t=0;t<n;t++)for(let e=0;e<a;e++){const c=I.fromRGBtoHSV(r[t][e]);I.desaturate(c);const[p,m,y]=I.fromHSVtoRGB(c);l[4*(t*a+e)+0]=p,l[4*(t*a+e)+1]=m,l[4*(t*a+e)+2]=y,l[4*(t*a+e)+3]=r[t][e][3]}return s}}class G{red;green;blue;constructor(r,o,a){this.red=r,this.green=o,this.blue=a}apply(r,o){let a=r[0].length,n=r.length;const s=o.createImageData(a,n),l=s.data;let t;for(let e=0;e<n;e++)for(let c=0;c<a;c++)t=this.red*r[e][c][0]+this.green*r[e][c][1]+this.blue*r[e][c][2],l[4*(e*a+c)+0]=t,l[4*(e*a+c)+1]=t,l[4*(e*a+c)+2]=t,l[4*(e*a+c)+3]=r[e][c][3];return s}}class k{constructor(){}apply(r,o){let a=r[0].length,n=r.length;const s=o.createImageData(a,n),l=s.data;for(let t=0;t<n;t++)for(let e=0;e<a;e++)l[4*(t*a+e)+0]=0,l[4*(t*a+e)+1]=r[t][e][1],l[4*(t*a+e)+2]=0,l[4*(t*a+e)+3]=r[t][e][3];return s}}class C{constructor(){}apply(r,o){let a=r[0].length,n=r.length;const s=o.createImageData(a,n),l=s.data;for(let t=0;t<n;t++)for(let e=0;e<a;e++)l[4*(t*a+e)+0]=255-r[t][e][0],l[4*(t*a+e)+1]=255-r[t][e][1],l[4*(t*a+e)+2]=255-r[t][e][2],l[4*(t*a+e)+3]=r[t][e][3];return s}}class O{constructor(){}apply(r,o){let a=r[0].length,n=r.length;const s=o.createImageData(a,n),l=s.data;for(let t=0;t<n;t++)for(let e=0;e<a;e++)l[4*(t*a+e)+0]=r[t][e][0],l[4*(t*a+e)+1]=0,l[4*(t*a+e)+2]=0,l[4*(t*a+e)+3]=r[t][e][3];return s}}class M{red;green;blue;constructor(r,o,a){this.red=r,this.green=o,this.blue=a}apply(r,o){let a=r[0].length,n=r.length;const s=o.createImageData(a,n),l=s.data;for(let t=0;t<n;t++)for(let e=0;e<a;e++)l[4*(t*a+e)+0]=this.red.forRed*r[t][e][0]+this.red.forGreen*r[t][e][1]+this.red.forBlue*r[t][e][2],l[4*(t*a+e)+1]=this.green.forRed*r[t][e][0]+this.green.forGreen*r[t][e][1]+this.green.forBlue*r[t][e][2],l[4*(t*a+e)+2]=this.blue.forRed*r[t][e][0]+this.blue.forGreen*r[t][e][1]+this.blue.forBlue*r[t][e][2],l[4*(t*a+e)+3]=r[t][e][3];return s}}class N{thresholdValue;constructor(r){this.thresholdValue=r}eraseOrMaximize(r){return r>=this.thresholdValue?255:0}apply(r,o){let a=r[0].length,n=r.length;const s=o.createImageData(a,n),l=s.data;for(let t=0;t<n;t++)for(let e=0;e<a;e++)l[4*(t*a+e)+0]=this.eraseOrMaximize(r[t][e][0]),l[4*(t*a+e)+1]=this.eraseOrMaximize(r[t][e][1]),l[4*(t*a+e)+2]=this.eraseOrMaximize(r[t][e][2]),l[4*(t*a+e)+3]=r[t][e][3];return s}}class j{reader;image;constructor(){this.reader=new FileReader,this.image=new Image}createImageElementFromFile(r,o){this.reader.onload=a=>{this.image.src=a.target.result,this.image.onload=n=>o(this.image)},this.reader.readAsDataURL(r)}}class S{static catchIfThrowedErrorIn(r){try{r()}catch(o){return alert(o),!0}return!1}}class V{constructor(){}apply(r,o){let a=r[0].length,n=r.length;const s=o.createImageData(a,n),l=s.data;for(let t=0;t<n;t++)for(let e=0;e<a;e++)l[4*(t*a+e)+0]=r[t][e][0],l[4*(t*a+e)+1]=r[t][e][1],l[4*(t*a+e)+2]=0,l[4*(t*a+e)+3]=r[t][e][3];return s}}class A{constructor(){}apply(r,o){let a=r[0].length,n=r.length;const s=o.createImageData(a,n),l=s.data;for(let t=0;t<n;t++)for(let e=0;e<a;e++)l[4*(t*a+e)+0]=r[t][e][0],l[4*(t*a+e)+1]=0,l[4*(t*a+e)+2]=r[t][e][2],l[4*(t*a+e)+3]=r[t][e][3];return s}}class H{constructor(){}apply(r,o){let a=r[0].length,n=r.length;const s=o.createImageData(a,n),l=s.data;for(let t=0;t<n;t++)for(let e=0;e<a;e++)l[4*(t*a+e)+0]=0,l[4*(t*a+e)+1]=r[t][e][1],l[4*(t*a+e)+2]=r[t][e][2],l[4*(t*a+e)+3]=r[t][e][3];return s}}const P=document.getElementById("img-loader-trigger"),F=document.getElementById("img-loader-container"),u=document.getElementById("img-container"),d=document.getElementById("filter-button"),w=document.getElementById("filter-options"),_=document.getElementById("img-downloader"),v=document.createElement("a"),i=new Map;let D,b,B,g,f;window.addEventListener("DOMContentLoaded",h=>{D=u.getContext("2d"),g=new R(D,u),u.width=0,u.height=0,i.set("grayscale",new G(.299,.587,.114)),i.set("sepia",new M({forRed:.393,forGreen:.769,forBlue:.189},{forRed:.349,forGreen:.686,forBlue:.168},{forRed:.272,forGreen:.534,forBlue:.131})),i.set("threshold",new N(128)),i.set("red",new O),i.set("green",new k),i.set("blue",new T),i.set("desaturate",new L),i.set("negative",new C),i.set("red&green",new V),i.set("red&blue",new A),i.set("green&blue",new H),F.addEventListener("change",a=>{f=F.files?.item(0);const n=s=>g.fillCanvas(s);if(B=S.catchIfThrowedErrorIn(()=>{if(!f)throw new Error("Invalid file!");if(!f.type.match("image/"))throw new Error("Only image files allowed!")}),!B){if(b){b.createImageElementFromFile(f,n);return}b=new j,b.createImageElementFromFile(f,n)}}),P.addEventListener("click",a=>{F.click()}),_.addEventListener("click",()=>{if(u.height==0||u.width==0)return;let a=prompt("Name of the file",`${f.name}`);a&&(v.download=`${a}`,v.href=u.toDataURL(f.type,1),v.click())});let r,o=new DocumentFragment;d.innerText="Original",r=r=document.createElement("button"),r.innerText="original",r.dataset.filterName="original",r.addEventListener("click",a=>{g.resetCanvasToOriginalImage(),d.innerText="Original",w.classList.remove("visible")}),o.appendChild(r),i.forEach((a,n)=>{r=document.createElement("button"),r.innerText=n,r.dataset.filterName=n,r.addEventListener("click",s=>{let l=s.currentTarget;if(!(u.width==0&&u.height==0)){switch(console.log(l.dataset.filterName),l.dataset.filterName){case"grayscale":g.applyFilter(i.get("grayscale")),d.innerText="Grayscale";break;case"sepia":g.applyFilter(i.get("sepia")),d.innerText="Sepia";break;case"threshold":g.applyFilter(i.get("threshold")),d.innerText="Threshold";break;case"red":g.applyFilter(i.get("red")),d.innerText="Full Red";break;case"green":g.applyFilter(i.get("green")),d.innerText="Full Green";break;case"blue":g.applyFilter(i.get("blue")),d.innerText="Full Blue";break;case"desaturate":g.applyFilter(i.get("desaturate")),d.innerText="Desaturate";break;case"negative":g.applyFilter(i.get("negative")),d.innerText="Negative";break;case"red&green":g.applyFilter(i.get("red&green")),d.innerText="Red & Green";break;case"red&blue":g.applyFilter(i.get("red&blue")),d.innerText="Red & Blue";break;case"green&blue":g.applyFilter(i.get("green&blue")),d.innerText="Green & Blue";break}w.classList.remove("visible")}}),o.appendChild(r)}),w.appendChild(o),d.addEventListener("click",a=>{w.classList.add("visible")})});
